# Migration `20201111174415-add-tax-rates`

This migration has been generated by Michal Miszczyszyn at 11/11/2020, 6:44:15 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Product" DROP COLUMN "taxRate",
ADD COLUMN "taxRateId" integer   

CREATE TABLE "public"."TaxRate" (
"id" SERIAL,
"name" text   NOT NULL ,
"value" Decimal(65,30)   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."Product" ADD FOREIGN KEY("taxRateId")REFERENCES "public"."TaxRate"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201110174348-add-tax-rate..20201111174415-add-tax-rates
--- datamodel.dml
+++ datamodel.dml
@@ -1,12 +1,12 @@
 generator client {
   provider = "prisma-client-js"
-  // previewFeatures = ["nativeTypes"]
+  // previewFeatures = []
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model User {
   id Int @default(autoincrement()) @id
@@ -45,15 +45,16 @@
   regularPrice Int
   discountPrice Int?
-  taxRate Float?
-
   type ProductType @default(SINGLE)
   userId Int
   addedBy User @relation(fields: [userId], references: [id])
+  taxRate TaxRate? @relation(fields: [taxRateId], references: [id])
+  taxRateId Int?
+
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now()) @updatedAt
 }
@@ -109,4 +110,10 @@
   CANCELLED
   REFUNDED
   FAILED
 }
+
+model TaxRate {
+  id Int @default(autoincrement()) @id
+  name String
+  value Float
+}
```


